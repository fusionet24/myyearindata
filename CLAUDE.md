# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

MyYearInData is a technical blog built with Quarto, focusing on data engineering, AI/ML, and cloud technologies. The site is deployed to Azure Static Web Apps via GitHub Actions.

## Quarto Blog Project
- This is a Quarto blog deployed on Azure Static Web Apps
- When modifying deployment-related configs (redirects, CSP headers, etc.), always ensure changes are in `staticwebapp.config.json` AND that it's included in Quarto's `resources` so it copies to `_site/`
- Never use meta tag approaches for CSP â€” always use Azure Static Web Apps config headers

## Common Commands

```bash
# Preview the site locally (with auto-refresh)
quarto preview

# Render the entire site
quarto render

# Verify Quarto installation
quarto check
```

## Architecture

### Site Structure

- `_quarto.yml` - Main site configuration (theme, navigation, metadata)
- `index.qmd` - Blog listing page (shows all posts)
- `about.qmd` - About page with author info
- `talks.qmd` - Speaking engagements page
- `posts/` - Blog posts directory
  - Each post lives in its own folder (e.g., `posts/agentic-diagramming/`)
  - Each post folder contains `index.qmd` and an `images/` subdirectory
  - `posts/_metadata.yml` - Default settings for all posts (freeze: true, title-block-banner: true)
- `_site/` - Rendered output (gitignored, generated by Quarto)
- `_freeze/` - Frozen computational output for reproducibility
- `infra/` - Azure ARM templates for deployment

### Post Structure

Every blog post follows this pattern:

```yaml
---
title: "Post Title"
author: "Scott Bell"
description: "Brief description"
date: "YYYY-MM-DD"
draft: false  # Set to true to hide from listings
categories:
  - category1
  - category2
---

Post content in Markdown/Quarto format...
```

**Important Post Conventions:**
- Posts with `draft: true` won't appear in the blog listing
- Images should be placed in an `images/` subdirectory within each post folder
- Reference images using relative paths: `![](images/diagram.png)`
- Posts can reference other posts: `[AI Content Labels](../AI-Content-Labels/index.qmd)`
- The `freeze: true` setting in `posts/_metadata.yml` prevents re-execution of code chunks

### Deployment

The site deploys automatically via GitHub Actions (`.github/workflows/render_quarto.yml`):

1. **Trigger**: Push to `main` branch or PR merge
2. **Build**: Installs Quarto on Ubuntu runner and runs `quarto render`
3. **Deploy**: Uploads `_site/` directory to Azure Static Web Apps (main branch only)

The workflow requires the `AZURE_STATIC_WEB_APPS_API_TOKEN_PROUD_SEA_08F1C9003` secret to be configured in the repository.

## Creating New Posts

1. Create a new directory under `posts/` with a descriptive kebab-case name
2. Create `index.qmd` with appropriate YAML frontmatter
3. Create `images/` subdirectory for any images
4. Set `draft: true` while working, then `draft: false` when ready to publish
5. Add a short URL redirect in `staticwebapp.config.json`:
   - Add an entry to the `routes` array with a memorable shortcode
   - Example: `{"route": "/s/MyShortcode", "redirect": "/posts/my-post-folder/", "statusCode": 301}`
6. Commit and push to deploy (on main branch)

## Content Categories

Common categories used in posts include: `ai`, `agents`, `agentic`, `azure`, `databricks`, `data-engineering`, `architecture`, `sql`, `llm`, `prompt-design`, `security`

## Styling

### CSS Scoping Rules
- When changing styles on this Quarto site, always scope CSS selectors precisely to the target area (e.g., `.quarto-title-banner` not just `h1`)
- Test that changes don't bleed into other areas (e.g., white text on white backgrounds elsewhere)
- Verify with both the banner area AND the main body content area

## Development Environment

### Python Environment
- Always use the project's configured venv (not system Python) for any notebook or script execution
- Check for required packages (databricks-connect, jupyter, etc.) before attempting renders
- When running PDF generation scripts, verify dependencies like Puppeteer browser binaries are available

## General Rules

### Workflow Preferences
- When creating multi-part blog series, always verify cross-linking URLs point to actual existing slugs before editing callout boxes
- When user requests a specific tool/format (e.g., 'Napkin AI diagram'), do NOT substitute a different tool (e.g., Veo3 video prompt)
- Ask for clarification if a referenced post or asset cannot be found rather than proceeding with assumptions
